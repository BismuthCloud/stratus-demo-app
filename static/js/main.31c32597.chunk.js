(this.webpackJsonpwx_explore=this.webpackJsonpwx_explore||[]).push([[0],{165:function(e,t,a){e.exports=a(364)},170:function(e,t,a){},360:function(e,t,a){},364:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(13),o=a.n(s),c=a(368),l=(a(170),a(23)),i=a(24),u=a(26),m=a(25),d=a(163),h=a(91),p=a(88),f=a(29),v=a(16),y=a(162),E=a(9),b=a(155),g=a(160),j=a(93),x=a(92),w=a(37),O=a(45),_=a.n(O),k=a(156),N=a(87),C=a(157),S=a.n(C).a.create({baseURL:"https://api.vortexweather.io/",timeout:3e4}),L={hrrr:"255,0,0",gfs:"0,255,0",nam:"0,0,255"},D=["1","3","6","12","15"];function P(e){return e[0].toUpperCase()+e.substring(1)}var A=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={location:null,metrics:null,sources:null,source_fields:null,summary:null,wx:null},n}return Object(i.a)(a,[{key:"getWx",value:function(){var e=this,t=Math.round((new Date).getTime()/1e3);S.get("/wx",{params:{lat:this.state.location.lat,lon:this.state.location.lon,start:t,end:t+259200}}).then((function(t){var a=t.data;return e.setState({wx:a})})),S.get("/wx/summarize",{params:{lat:this.state.location.lat,lon:this.state.location.lon,days:1}}).then((function(t){var a=t.data;return e.setState({summary:a})}))}},{key:"componentDidMount",value:function(){var e=this;S.get("/sources").then((function(t){var a,n=t.data,r={},s={},o=Object(w.a)(n);try{for(o.s();!(a=o.n()).done;){var c=a.value;r[c.id]=c;var l,i=Object(w.a)(c.fields);try{for(i.s();!(l=i.n()).done;){var u=l.value;s[u.id]=u}}catch(m){i.e(m)}finally{i.f()}}}catch(m){o.e(m)}finally{o.f()}e.setState({sources:r,source_fields:s})})),S.get("/metrics").then((function(t){var a,n=t.data,r={},s=Object(w.a)(n);try{for(s.s();!(a=s.n()).done;){var o=a.value;r[o.id]=o}}catch(c){s.e(c)}finally{s.f()}e.setState({metrics:r})})),void 0!==this.props.match.params.loc_id?S.get("/location/".concat(this.props.match.params.loc_id)).then((function(t){var a=t.data;e.setState({location:a})})):void 0!==this.props.match.params.lat&&void 0!==this.props.match.params.lon&&S.get("/location/by_coords",{params:{lat:this.props.match.params.lat,lon:this.props.match.params.lon}}).then((function(t){var a=t.data;e.setState({location:{lat:e.props.match.params.lat,lon:e.props.match.params.lon,name:"Near ".concat(a.name)}})}))}},{key:"componentDidUpdate",value:function(e,t){null!=this.state.location&&t.location!==this.state.location&&(this.setState({wx:null,summary:null}),this.getWx())}},{key:"chartjsData",value:function(){var e,t={},a=Object(w.a)(this.state.wx.ordered_times);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,s=Object(w.a)(this.state.wx.data[r]);try{for(s.s();!(n=s.n()).done;){var o=n.value,c=this.state.source_fields[o.src_field_id],l=this.state.metrics[c.metric_id],i=this.state.sources[c.source_id];l.id in t||(t[l.id]={}),i.id in t[l.id]||(t[l.id][i.id]={}),o.run_time in t[l.id][i.id]||(t[l.id][i.id][o.run_time]=[]);var u=this.props.converter.convert(o.value,l.units),m=Object(x.a)(u,1)[0];t[l.id][i.id][o.run_time].push({x:new Date(1e3*r),y:m})}}catch(k){s.e(k)}finally{s.f()}}}catch(k){a.e(k)}finally{a.f()}var d={};for(var h in t)if(D.includes(h))for(var p in d[h]=[],t[h]){var f=this.state.sources[p],v=0,y=0;for(var E in t[h][p])0===v||E<v?v=E:E>y&&(y=E);for(var b in t[h][p]){var g=.15;b===y&&(g=.8);var j=_.a.unix(b).utc().format("HH[Z] dddd Do")+" "+f.name,O="rgba("+L[f.short_name]+","+g+")";d[h].push({label:j,data:t[h][p][b],fill:!1,backgroundColor:O,borderColor:O,pointBorderColor:O})}}return d}},{key:"coreMetricsBox",value:function(e){var t=this.state.summary[e],a="";switch(t.cloud_cover[0].cover){case"clear":case"mostly clear":a="wi-day-sunny";break;case"partly cloudy":a="wi-day-cloudy-high";break;case"mostly cloudy":a="wi-cloud";break;case"cloudy":a="wi-cloudy";break;default:a="wi-alien"}return r.a.createElement(f.a,{className:"justify-content-md-center"},r.a.createElement(v.a,{md:2},r.a.createElement("i",{style:{fontSize:"7em"},className:"wi "+a})),r.a.createElement(v.a,{md:3},r.a.createElement("h4",null,this.props.converter.convert(t.temps[0].temperature,"K")," ",P(t.cloud_cover[0].cover)),r.a.createElement("p",null,"High: ",this.props.converter.convert(t.high.temperature,"K")),r.a.createElement("p",null,"Low: ",this.props.converter.convert(t.low.temperature,"K"))))}},{key:"summarize",value:function(e){var t,a=[],n=Object(w.a)(this.state.summary[e].summary.components.entries());try{for(n.s();!(t=n.n()).done;){var s=Object(x.a)(t.value,2),o=s[0],c=s[1],l="";l=0===o?P(c.text):c.text,l+=" ",c.type,a.push(r.a.createElement("span",{key:o},l))}}catch(i){n.e(i)}finally{n.f()}return r.a.createElement("span",null,a)}},{key:"render",value:function(){if(null==this.state.summary||null==this.state.sources||null==this.state.source_fields||null==this.state.metrics)return r.a.createElement(N.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."));var e=[];if(null==this.state.wx)e.push(r.a.createElement(N.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")));else{var t=this.chartjsData(),a={scales:{xAxes:[{type:"time",distribution:"linear",time:{unit:"hour"},ticks:{min:_()(),max:_()().add(3,"days")}}]},legend:{display:!1}};for(var n in t){var s=this.state.metrics[n],o={datasets:t[n]},c=Object(j.a)(Object(j.a)({},a),{},{title:{display:!0,text:s.name}});e.push(r.a.createElement(f.a,null,r.a.createElement(v.a,null,r.a.createElement(k.Line,{key:s.name,data:o,options:c}))))}}return r.a.createElement("div",null,r.a.createElement(f.a,{className:"justify-content-md-center"},r.a.createElement(v.a,{md:"auto"},r.a.createElement("h2",null,this.state.location.name))),this.coreMetricsBox(0),r.a.createElement(f.a,{className:"justify-content-md-center"},r.a.createElement(v.a,{md:"auto"},r.a.createElement("p",{style:{fontSize:"1.5em"}},this.summarize(0)))),r.a.createElement("hr",null),e)}}]),a}(r.a.Component),M=a(158),z=function(e){var t=e.loc;return r.a.createElement("div",null,r.a.createElement("span",null,t.name))},T=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1,options:[]},e._handleSearch=function(t){e.setState({isLoading:!0}),S.get("/location/search",{params:{q:t}}).then((function(t){var a=t.data;e.setState({isLoading:!1,options:a})}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(M.AsyncTypeahead,Object.assign({},this.state,{placeholder:"Location",minLength:3,onSearch:this._handleSearch,labelKey:"name",renderMenuItemChildren:function(e,t){return r.a.createElement(z,{key:e.id,loc:e})},onChange:function(t){t.length>0&&e.props.onChange(t)}}))}}]),a}(r.a.Component),B=function(){function e(){Object(l.a)(this,e)}return Object(i.a)(e,[{key:"round",value:function(e,t){return t in this.decimalPlaces?[Math.round(e*Math.pow(10,this.decimalPlaces[t]))/Math.pow(10,this.decimalPlaces[t]),t]:[e,t]}}]),e}(),H=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).decimalPlaces={F:0,ft:0,mph:0,inHg:2},e}return Object(i.a)(a,[{key:"convert",value:function(e,t){switch(t){case"K":return this.round(1.8*(e-273.15)+32,"F");case"m":return this.round(3.2808*e,"ft");case"m/s":return this.round(2.237*e,"mph");case"Pa":return this.round(2953e-7*e,"inHg");default:return this.round(e,t)}}}]),a}(B),I=(a(360),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={location:null,unitConverter:new H},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;"/"===this.props.location.pathname&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var a=t.coords.latitude,n=t.coords.longitude;e.props.history.push("/coords/".concat(a,"/").concat(n))}));var t=(new Date).getFullYear();return r.a.createElement("div",{className:"App"},r.a.createElement(h.a,{bg:"dark",variant:"dark"},r.a.createElement(h.a.Brand,null,"Wx Explore"),r.a.createElement(d.a,{className:"mr-auto"}),r.a.createElement(y.a,{inline:!0},r.a.createElement(T,{onChange:function(t){var a=t[0].id;e.props.history.push("/id/".concat(a))}}))),r.a.createElement(p.a,{style:{marginTop:"1em"}},r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/id/:loc_id",component:function(t){return r.a.createElement(A,Object.assign({converter:e.state.unitConverter},t))}}),r.a.createElement(E.a,{path:"/coords/:lat/:lon",component:function(t){return r.a.createElement(A,Object.assign({converter:e.state.unitConverter},t))}}),r.a.createElement(E.a,{path:"/"},r.a.createElement(f.a,{className:"justify-content-md-center"},r.a.createElement(v.a,{md:"auto"},r.a.createElement("h4",null,"Enter your location to get started")))))),r.a.createElement("footer",{className:"footer"},r.a.createElement(p.a,{fluid:!0,style:{height:"100%"}},r.a.createElement(f.a,{className:"h-100"},r.a.createElement(v.a,{xs:"4",className:"align-self-center"},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kallsyms/wx_explore",className:"text-muted"},"kallsyms/wx_explore on ",r.a.createElement(b.a,{icon:g.a,size:"lg"})),r.a.createElement("br",null),r.a.createElement("span",{className:"text-muted"},"\xa9 ",t)),r.a.createElement(v.a,{xs:"8",className:"align-self-center"},r.a.createElement("span",{className:"text-muted",style:{fontSize:"0.75em",display:"block",lineHeight:"1.5em"}},"The data on this website is best-effort, and no guarantees are made about the availability or correctness of the data. It should not be used for critical decision making."))))))}}]),a}(r.a.Component)),K=Object(E.f)(I),U=a(85);c.a({dsn:Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_API_ENDPOINT:"https://api.vortexweather.io/"}).SENTRY_DSN}),o.a.render(r.a.createElement(U.a,null,r.a.createElement(K,null)),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.31c32597.chunk.js.map